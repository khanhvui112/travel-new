{"ast":null,"code":"import _objectSpread from\"D:/photo/home/Mytravel/Front-End-ReactJs/travel-new/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"D:/photo/home/Mytravel/Front-End-ReactJs/travel-new/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"D:\\\\photo\\\\home\\\\Mytravel\\\\Front-End-ReactJs\\\\travel-new\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{useFormik}from'formik';import React from'react';import*as Yup from'yup';import userService from'../../../services/userService';import authentication from'../../../services/athenticationService';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function AddUser(){var _formik$errors,_formik$errors2,_formik$errors3,_formik$errors4;var formik=useFormik({initialValues:{email:'',name:'',password:'',role:null},validateOnChange:false,validateOnBlur:false,validationSchema:Yup.object({email:Yup.string().email('Email sai định dạng').required(\"Vui lòng địa chỉ email\").test('Unique Email','Email đã được sử dụng',// <- key, message\nfunction(value){var data=JSON.stringify({\"email\":value});var exitsEmail=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return authentication.exitsEmail(user);case 3:response=_context.sent;if(!(response.status===200)){_context.next=8;break;}return _context.abrupt(\"return\",true);case 8:return _context.abrupt(\"return\",false);case 9:_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);return _context.abrupt(\"return\",false);case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function exitsEmail(_x){return _ref.apply(this,arguments);};}();return exitsEmail(data);}),name:Yup.string().required('Vui lòng nhập tên'),role:Yup.number().nullable().required(\"Vui lòng chọn quyền\"),password:Yup.string().min(8,'Mật khẩu tối thiểu 8 kí tự').required(\"Vui lòng nhập mật khẩu\")}),onSubmit:function onSubmit(values,_ref2){var resetForm=_ref2.resetForm;handleCreate(values);}});var handleCreate=function handleCreate(data){var FormData=require('form-data');var userData=new FormData();userData.append('name',data.name);userData.append('email',data.email);userData.append('password',data.password);var newArray=data.role.map(function(str){return Number(str);});userData.append('idRole',newArray);var create=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return userService.create(data);case 2:alert(\"Thêm mới thành công\");window.location.reload();case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function create(_x2){return _ref3.apply(this,arguments);};}();try{create(userData);}catch(error){console.log(\"Fail call api \"+error);}};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:formik.handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Th\\xEAm m\\u1EDBi ng\\u01B0\\u1EDDi d\\xF9ng\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"exampleInputEmail1\",children:\"T\\xEAn ng\\u01B0\\u1EDDi d\\xF9ng\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"input\",id:\"name\",name:\"name\",className:\"title form-control\"},formik.getFieldProps(\"name\"))),/*#__PURE__*/_jsx(\"div\",{className:\"input-group\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-center text-danger\",children:formik.touched.name&&((_formik$errors=formik.errors)===null||_formik$errors===void 0?void 0:_formik$errors.name)})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"exampleFormControlTextarea1\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"input\",id:\"email\",name:\"email\",className:\"title form-control\"},formik.getFieldProps(\"email\"))),/*#__PURE__*/_jsx(\"div\",{className:\"input-group\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-center text-danger\",children:formik.touched.email&&((_formik$errors2=formik.errors)===null||_formik$errors2===void 0?void 0:_formik$errors2.email)})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"exampleFormControlTextarea1\",children:\"M\\u1EADt kh\\u1EA9u\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"password\",id:\"password\",name:\"password\",className:\"title form-control\"},formik.getFieldProps(\"password\"))),/*#__PURE__*/_jsx(\"div\",{className:\"input-group\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-center text-danger\",children:formik.touched.password&&((_formik$errors3=formik.errors)===null||_formik$errors3===void 0?void 0:_formik$errors3.password)})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"exampleFormControlFile1\",children:\"Ch\\u1ECDn quy\\u1EC1n ng\\u01B0\\u1EDDi d\\xF9ng\"}),/*#__PURE__*/_jsxs(\"select\",_objectSpread(_objectSpread({id:\"role\",name:\"role\",class:\"form-select\",multiple:true,\"aria-label\":\"Default select example\"},formik.getFieldProps(\"role\")),{},{children:[/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"User\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3\",children:\"Admin\"})]})),/*#__PURE__*/_jsx(\"div\",{className:\"input-group\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-center text-danger\",children:formik.touched.role&&((_formik$errors4=formik.errors)===null||_formik$errors4===void 0?void 0:_formik$errors4.role)})})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary btn-submit\",children:\"Submit\"})]})})});}","map":{"version":3,"sources":["D:/photo/home/Mytravel/Front-End-ReactJs/travel-new/src/components/admin/user_admin/AddUser.js"],"names":["useFormik","React","Yup","userService","authentication","AddUser","formik","initialValues","email","name","password","role","validateOnChange","validateOnBlur","validationSchema","object","string","required","test","value","data","JSON","stringify","exitsEmail","user","response","status","number","nullable","min","onSubmit","values","resetForm","handleCreate","FormData","require","userData","append","newArray","map","str","Number","create","alert","window","location","reload","error","console","log","handleSubmit","getFieldProps","touched","errors"],"mappings":"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","sourcesContent":["import { useFormik } from 'formik';\r\nimport React from 'react';\r\nimport * as Yup from 'yup';\r\nimport userService from '../../../services/userService'\r\nimport authentication from '../../../services/athenticationService'\r\n \r\n\r\nexport default function AddUser() {\r\n\r\n\r\n    const formik = useFormik({\r\n        initialValues:{\r\n          email:'',\r\n          name: '',\r\n          password:'',\r\n          role:null,\r\n        },\r\n        validateOnChange:false,\r\n        validateOnBlur:false,\r\n        validationSchema:Yup.object({\r\n          email: Yup.string()\r\n          .email('Email sai định dạng')\r\n          .required(\"Vui lòng địa chỉ email\")\r\n          .test('Unique Email', 'Email đã được sử dụng', // <- key, message\r\n                function (value) {\r\n                  const data = JSON.stringify({\r\n                    \"email\": value\r\n                  });\r\n                  const exitsEmail = async (user)=>{\r\n                    try{\r\n                      const response= await authentication.exitsEmail(user);   \r\n                      if(response.status===200) {\r\n                        return true;\r\n                      }else\r\n                      return false;\r\n                      \r\n                    }catch(error){\r\n                      return false;\r\n                    }\r\n                }\r\n                return exitsEmail(data)\r\n                }\r\n            ),        \r\n          name: Yup.string()\r\n          .required('Vui lòng nhập tên'),\r\n          role: Yup\r\n          .number()\r\n          .nullable()\r\n          .required(\"Vui lòng chọn quyền\"),\r\n          password: Yup.string()\r\n          .min(8,'Mật khẩu tối thiểu 8 kí tự')\r\n          .required(\"Vui lòng nhập mật khẩu\"),\r\n        }),\r\n        onSubmit: (values,{ resetForm }) =>{\r\n            handleCreate(values)\r\n                 \r\n        },\r\n      });    \r\n \r\n \r\n\r\n\r\n     const handleCreate= (data)=>{\r\n      var FormData = require('form-data');\r\n      const userData = new FormData();\r\n      userData.append('name', data.name);\r\n      userData.append('email', data.email);\r\n      userData.append('password', data.password);\r\n      const newArray = data.role.map(str => {\r\n        return Number(str);\r\n      });\r\n      userData.append('idRole', newArray);\r\n     \r\n      \r\n      const create = async (data)=>{\r\n        await userService.create(data);    \r\n        alert(\"Thêm mới thành công\") \r\n        window.location.reload()\r\n        \r\n       }\r\n        try{\r\n         create(userData);            \r\n        }catch(error) {\r\n            console.log(\"Fail call api \"+error);\r\n            }\r\n      }\r\n  return (\r\n    <>\r\n    <div className=\"container\">\r\n    <form onSubmit={formik.handleSubmit}>\r\n        <div className=\"form-group\">\r\n        <h2>Thêm mới người dùng</h2>\r\n            <label htmlFor=\"exampleInputEmail1\">Tên người dùng</label>\r\n            <input type=\"input\" id=\"name\" name=\"name\" className=\"title form-control\" \r\n                {...formik.getFieldProps(\"name\")}\r\n                     />\r\n            <div  className=\"input-group\"><span className=\"text-center text-danger\">{formik.touched.name&&formik.errors?.name}</span></div>\r\n            \r\n            \r\n        </div>\r\n        <div className=\"form-group\">\r\n            <label htmlFor=\"exampleFormControlTextarea1\">Email</label>\r\n            <input type=\"input\" id=\"email\" name=\"email\" className=\"title form-control\"\r\n                {...formik.getFieldProps(\"email\")} \r\n                  />\r\n            <div  className=\"input-group\"><span className=\"text-center text-danger\">{formik.touched.email&&formik.errors?.email}</span></div>       \r\n        </div>\r\n        <div className=\"form-group\">\r\n            <label htmlFor=\"exampleFormControlTextarea1\">Mật khẩu</label>\r\n            <input type=\"password\" id=\"password\" name=\"password\" className=\"title form-control\"\r\n                {...formik.getFieldProps(\"password\")} \r\n                  />\r\n            <div  className=\"input-group\"><span className=\"text-center text-danger\">{formik.touched.password&&formik.errors?.password}</span></div>       \r\n        </div>\r\n        <div className=\"form-group\">    \r\n            <label htmlFor=\"exampleFormControlFile1\">Chọn quyền người dùng</label>\r\n            <select id=\"role\" name=\"role\" class=\"form-select\" multiple aria-label=\"Default select example\" {...formik.getFieldProps(\"role\")} >\r\n            \r\n            <option value=\"1\">User</option>\r\n            <option value=\"3\">Admin</option>\r\n            \r\n            </select>\r\n            <div  className=\"input-group\"><span className=\"text-center text-danger\">{formik.touched.role&&formik.errors?.role}</span></div>\r\n        </div>\r\n           \r\n        <button type=\"submit\" className=\"btn btn-primary btn-submit\">Submit</button>\r\n    </form>  \r\n    </div>\r\n    \r\n    </>\r\n  )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}