{"ast":null,"code":"import _defineProperty from\"D:/photo/home/Mytravel/Front-End-ReactJs/travel-new/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _asyncToGenerator from\"D:/photo/home/Mytravel/Front-End-ReactJs/travel-new/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"D:/photo/home/Mytravel/Front-End-ReactJs/travel-new/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/photo/home/Mytravel/Front-End-ReactJs/travel-new/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"D:\\\\photo\\\\home\\\\Mytravel\\\\Front-End-ReactJs\\\\travel-new\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useEffect,useState}from'react';import PaginationTable from'../../common/PaginationTable';import RowTour from'./RowTour';import tourService from'../../../services/TourService';import{CKEditor}from'@ckeditor/ckeditor5-react';import ClassicEditor from'@ckeditor/ckeditor5-build-classic';import AddNew from'../place_admin/AddNew';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function TourAdmin(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),tours=_useState2[0],setTours=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),page=_useState4[0],setPage=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),tourUpdate=_useState6[0],setTourUpdate=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),tour=_useState8[0],setTour=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),idDelete=_useState10[0],setIdDelete=_useState10[1];//phân trang\nvar increment=function increment(page){setPage(page);};var handleUpdate=function handleUpdate(){var data=_objectSpread(_objectSpread({},tour),tourUpdate);console.log(data);var FormData=require('form-data');var tourData=new FormData();tourData.append('title',data.title);tourData.append('price',data.price);tourData.append('totalDay',data.totalDay);tourData.append('detail',data.detail);tourData.append('totalPerson',data.totalPerson);tourData.append('departure',data.departure);Array.from(data.file).forEach(function(file){tourData.append('files',file);});var update=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(id,data){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return tourService.update(id,data);case 2:case\"end\":return _context.stop();}}},_callee);}));return function update(_x,_x2){return _ref.apply(this,arguments);};}();var create=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return tourService.create(data);case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function create(_x3){return _ref2.apply(this,arguments);};}();try{if(data.id){update(data.id,tourData);}else{create(tourData);}alert(\"Sửa thành công\");document.location.reload(true);}catch(error){console.log(\"Fail call api \"+error);}};var handleDelete=function handleDelete(id){var deleteHotel=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return tourService.remove(id);case 2:setIdDelete(id);case 3:case\"end\":return _context3.stop();}}},_callee3);}));return function deleteHotel(_x4){return _ref3.apply(this,arguments);};}();try{var answer=window.confirm(\"bạn thật sự muốn xóa\");if(answer){deleteHotel(id);}}catch(error){console.log(\"Fail call api \"+error);}};var getIdUpdate=function getIdUpdate(tour){setTourUpdate(tour);setTour(tour);};var getBypage=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(page){var response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return tourService.getByPage(page);case 2:response=_context4.sent;setTours(response.data.data);case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function getBypage(_x5){return _ref4.apply(this,arguments);};}();useEffect(function(){try{getBypage(page);}catch(err){console.log(\"Fail call api \"+err);}},[page,idDelete]);var setParams=function setParams(event){if(event.target.name!==\"file\"){setTourUpdate(_objectSpread(_objectSpread({},tourUpdate),{},_defineProperty({},event.target.name,event.target.value)));}else{setTourUpdate(_objectSpread(_objectSpread({},tourUpdate),{},_defineProperty({},event.target.name,event.target.files)));}};var handleCkEditor=function handleCkEditor(event,editor){setTourUpdate(_objectSpread(_objectSpread({},tourUpdate),{},{'detail':editor.getData()}));};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(AddNew,{}),/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-12\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Danh s\\xE1ch tour du l\\u1ECBch\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"table table-bordered\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Id\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"T\\xEAn tour\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"\\u1EA2nh\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Chi ti\\u1EBFt\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Gi\\xE1\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Th\\u1EDDi gian tour\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"T\\u1ED5ng s\\u1ED1 ng\\u01B0\\u1EDDi\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"\\u0110\\u1ECBa \\u0111i\\u1EC3m b\\u1EAFt \\u0111\\u1EA7u\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{id:\"show_table\",children:tours&&Array.from(tours.pageRespDtos).map(function(tour,index){return/*#__PURE__*/_jsx(RowTour,{getIdUpdate:getIdUpdate,handleDelete:handleDelete,tour:tour},index);})})]}),/*#__PURE__*/_jsx(\"nav\",{\"aria-label\":\"Page navigation example\",children:/*#__PURE__*/_jsx(PaginationTable,{onClick:increment,totalPage:tours===null||tours===void 0?void 0:tours.totalPage})})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"modal fade bd-example-modal-lg kkkk\",id:\"exampleModal\",tabIndex:-1,role:\"dialog\",\"aria-labelledby\":\"exampleModalLabel\",\"aria-hidden\":\"true\",children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-dialog modal-lg\",role:\"document\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title \",id:\"exampleModalLabel\",children:\"Modal title\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"close\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\",children:/*#__PURE__*/_jsx(\"span\",{\"aria-hidden\":\"true\",children:\"\\xD7\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"C\\u1EADp nh\\u1EADt Tour \"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"exampleInputEmail1\",children:\"T\\xEAn \"}),/*#__PURE__*/_jsx(\"input\",{type:\"input\",name:\"title\",className:\"title form-control\",onChange:setParams,value:tourUpdate===null||tourUpdate===void 0?void 0:tourUpdate.title})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"exampleFormControlTextarea1\",children:\"Gi\\xE1\"}),/*#__PURE__*/_jsx(\"input\",{type:\"input\",name:\"price\",className:\"title form-control\",onChange:setParams,value:tourUpdate===null||tourUpdate===void 0?void 0:tourUpdate.price})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"exampleFormControlTextarea1\",children:\"T\\u1ED5ng s\\u1ED1 ng\\xE0y\"}),/*#__PURE__*/_jsx(\"input\",{type:\"input\",name:\"totalDay\",className:\"title form-control\",onChange:setParams,value:tourUpdate===null||tourUpdate===void 0?void 0:tourUpdate.totalDay})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"exampleFormControlTextarea1\",children:\"T\\u1ED5ng s\\u1ED1 ng\\u01B0\\u1EDDi\"}),/*#__PURE__*/_jsx(\"input\",{type:\"input\",name:\"totalPerson\",className:\"title form-control\",onChange:setParams,value:tourUpdate===null||tourUpdate===void 0?void 0:tourUpdate.totalPerson})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"exampleFormControlTextarea1\",children:\"\\u0110i\\u1EC3m xu\\u1EA5t ph\\xE1t\"}),/*#__PURE__*/_jsx(\"input\",{type:\"input\",name:\"departure\",className:\"title form-control\",onChange:setParams,value:tourUpdate===null||tourUpdate===void 0?void 0:tourUpdate.departure})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"exampleFormControlFile1\",children:\"Ch\\u1ECDn \\u1EA3nh\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"file\",className:\"form-control-file\",multiple:\"multiple\",onChange:setParams})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"exampleFormControlFile1\",children:\"M\\xF4 t\\u1EA3\"}),/*#__PURE__*/_jsx(CKEditor,{editor:ClassicEditor,name:\"detail\",onReady:function onReady(editor){},onChange:handleCkEditor,data:tourUpdate===null||tourUpdate===void 0?void 0:tourUpdate.detail})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-primary btn-submit\",onClick:handleUpdate,children:\"Submit\"})]})})]})})})]});}export default TourAdmin;","map":{"version":3,"sources":["D:/photo/home/Mytravel/Front-End-ReactJs/travel-new/src/components/admin/tour_admin/TourAdmin.js"],"names":["React","useEffect","useState","PaginationTable","RowTour","tourService","CKEditor","ClassicEditor","AddNew","TourAdmin","tours","setTours","page","setPage","tourUpdate","setTourUpdate","tour","setTour","idDelete","setIdDelete","increment","handleUpdate","data","console","log","FormData","require","tourData","append","title","price","totalDay","detail","totalPerson","departure","Array","from","file","forEach","update","id","create","alert","document","location","reload","error","handleDelete","deleteHotel","remove","answer","window","confirm","getIdUpdate","getBypage","getByPage","response","err","setParams","event","target","name","value","files","handleCkEditor","editor","getData","pageRespDtos","map","index","totalPage"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport PaginationTable from '../../common/PaginationTable'\r\nimport RowTour from './RowTour'\r\nimport tourService from '../../../services/TourService'\r\nimport { CKEditor } from '@ckeditor/ckeditor5-react'\r\nimport ClassicEditor from '@ckeditor/ckeditor5-build-classic'\r\nimport AddNew from '../place_admin/AddNew'\r\n\r\nfunction TourAdmin() {\r\n  const [tours, setTours] = useState();\r\n  const [page, setPage] = useState(1);\r\n  const [tourUpdate, setTourUpdate] = useState();\r\n  const [tour, setTour] = useState();\r\n  const [idDelete, setIdDelete] = useState();\r\n\r\n  //phân trang\r\n const increment = (page) => {\r\n  setPage(page)\r\n}\r\nconst handleUpdate = ()=>{\r\n  const data = {...tour,...tourUpdate}\r\n  console.log(data);\r\n  \r\n   \r\n const FormData = require('form-data');\r\n const tourData = new FormData();\r\n tourData.append('title', data.title);\r\n tourData.append('price', data.price);\r\n tourData.append('totalDay', data.totalDay);\r\n tourData.append('detail',data.detail);\r\n tourData.append('totalPerson',data.totalPerson);\r\n tourData.append('departure',data.departure);\r\n Array.from( data.file).forEach(file => {\r\n  tourData.append('files', file);\r\n});\r\n \r\n\r\n const update = async (id,data)=>{\r\n  await tourService.update(id, data);    \r\n}\r\nconst create = async (data)=>{\r\n  await tourService.create(data);    \r\n }\r\n try{\r\n   if(data.id){\r\n    update(data.id, tourData); \r\n   }else{\r\n    create(tourData);\r\n   }\r\n   alert(\"Sửa thành công\")\r\n   document.location.reload(true);   \r\n     \r\n      \r\n }catch(error) {\r\n     console.log(\"Fail call api \"+error);\r\n     }\r\n}\r\nconst handleDelete = (id) => {\r\n  const deleteHotel = async (id)=>{\r\n    await tourService.remove(id);   \r\n    setIdDelete(id);\r\n }\r\n try{\r\n  const answer = window.confirm(\"bạn thật sự muốn xóa\");\r\n  if (answer) {\r\n    deleteHotel(id); \r\n} \r\n    \r\n}catch(error) {\r\n  console.log(\"Fail call api \"+error);\r\n  }\r\n}\r\nconst getIdUpdate = (tour) => {\r\n  setTourUpdate(tour);\r\n  setTour(tour);\r\n}\r\n  const getBypage = async (page)=>{\r\n    const response= await tourService.getByPage(page) \r\n    setTours(response.data.data) \r\n     \r\n}\r\n  useEffect( ()=>{\r\n      try{\r\n          getBypage(page);\r\n      }\r\n      catch(err){\r\n          console.log(\"Fail call api \"+err);\r\n    } \r\n  },[page,idDelete])\r\n  const setParams = (event) => {\r\n    if(event.target.name!==\"file\"){\r\n      setTourUpdate({...tourUpdate,[event.target.name]:event.target.value});\r\n    }else{\r\n      setTourUpdate({...tourUpdate,[event.target.name]:event.target.files});\r\n    }  \r\n}\r\nconst handleCkEditor = (event, editor) => {\r\n  setTourUpdate({...tourUpdate,'detail':editor.getData()})\r\n}\r\n\r\n    return (\r\n          <>\r\n            <AddNew/>\r\n            <div className=\"container\">\r\n                <div className=\"row\">\r\n                  <div className=\"col-12\">\r\n                    <h2>Danh sách tour du lịch</h2>\r\n                    <table className=\"table table-bordered\">\r\n                      <thead>\r\n                        <tr>\r\n                          <th scope=\"col\">Id</th>\r\n                          <th scope=\"col\">Tên tour</th>\r\n                          <th scope=\"col\">Ảnh</th>\r\n                          <th scope=\"col\">Chi tiết</th>\r\n                          <th scope=\"col\">Giá</th>\r\n                          <th scope=\"col\">Thời gian tour</th>\r\n                          <th scope=\"col\">Tổng số người</th>\r\n                          <th scope=\"col\">Địa điểm bắt đầu</th>\r\n                          <th scope=\"col\">Action</th>\r\n                        </tr>\r\n                      </thead>\r\n                      <tbody id=\"show_table\"  >\r\n                        {\r\n                        tours&&  Array.from(tours.pageRespDtos).map((tour,index) => {              \r\n                            return (<RowTour key={index} getIdUpdate={getIdUpdate} handleDelete={handleDelete}  tour={tour}/>)})   \r\n                        }                              \r\n                      </tbody>\r\n                    </table>\r\n                    <nav aria-label=\"Page navigation example\">\r\n                      <PaginationTable onClick={increment} totalPage={tours?.totalPage}/>\r\n                    </nav>                    \r\n                  </div>\r\n                </div>\r\n            </div>\r\n      <div className=\"modal fade bd-example-modal-lg kkkk\" id=\"exampleModal\" tabIndex={-1} role=\"dialog\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\r\n    <div className=\"modal-dialog modal-lg\" role=\"document\">\r\n      <div className=\"modal-content\">\r\n        <div className=\"modal-header\">\r\n          <h5 className=\"modal-title \" id=\"exampleModalLabel\">Modal title</h5>\r\n          <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\r\n            <span aria-hidden=\"true\">×</span>\r\n          </button>\r\n        </div>\r\n        <div className=\"modal-body\">\r\n        <form>\r\n        <div className=\"form-group\">\r\n        <h2>Cập nhật Tour </h2>\r\n            <label htmlFor=\"exampleInputEmail1\">Tên </label>\r\n            <input type=\"input\" name=\"title\" className=\"title form-control\" onChange={setParams}   value={tourUpdate?.title}    />\r\n        </div>\r\n        <div className=\"form-group\">\r\n            <label htmlFor=\"exampleFormControlTextarea1\">Giá</label>\r\n            <input type=\"input\" name=\"price\" className=\"title form-control\" onChange={setParams} value={tourUpdate?.price}    />       \r\n        </div>\r\n        <div className=\"form-group\">\r\n            <label htmlFor=\"exampleFormControlTextarea1\">Tổng số ngày</label>\r\n            <input type=\"input\" name=\"totalDay\" className=\"title form-control\" onChange={setParams} value={tourUpdate?.totalDay}    />       \r\n        </div>\r\n        <div className=\"form-group\">\r\n            <label htmlFor=\"exampleFormControlTextarea1\">Tổng số người</label>\r\n            <input type=\"input\" name=\"totalPerson\" className=\"title form-control\" onChange={setParams} value={tourUpdate?.totalPerson}    />       \r\n        </div>\r\n        <div className=\"form-group\">\r\n            <label htmlFor=\"exampleFormControlTextarea1\">Điểm xuất phát</label>\r\n            <input type=\"input\" name=\"departure\" className=\"title form-control\" onChange={setParams} value={tourUpdate?.departure}    />       \r\n        </div>\r\n        <div className=\"form-group\">    \r\n            <label htmlFor=\"exampleFormControlFile1\">Chọn ảnh</label>\r\n            <input type=\"file\" name=\"file\" className=\"form-control-file\" multiple=\"multiple\" onChange={setParams}   />\r\n        </div>\r\n        <div className=\"form-group\">    \r\n            <label htmlFor=\"exampleFormControlFile1\">Mô tả</label>\r\n            \r\n            <CKEditor \r\n                editor={ClassicEditor}\r\n                name = \"detail\"\r\n                onReady={ editor =>{\r\n                }\r\n              }\r\n              onChange={handleCkEditor}\r\n              \r\n              data={tourUpdate?.detail}\r\n                />\r\n            \r\n        </div>           \r\n        <button type=\"button\" className=\"btn btn-primary btn-submit\" onClick={handleUpdate}>Submit</button>\r\n      </form>\r\n        </div>\r\n         \r\n      </div>\r\n    </div>\r\n  </div>         \r\n        </>           \r\n          \r\n    )\r\n}\r\n\r\nexport default TourAdmin\r\n"]},"metadata":{},"sourceType":"module"}